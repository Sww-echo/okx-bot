---
# 双均线自动交易系统策略文档 (Double Moving Average Trading System)

## 1. 系统概述
本系统基于“双均线”逻辑，利用6条移动平均线（3条MA和3条EMA）的形态关系（密集与发散）来识别趋势的启动与延续。系统属于**趋势跟随策略**，主张高盈亏比（High R:R），低胜率，通过严格的资金管理实现长期盈利。

**适用标的**：BTC, ETH, SOL（高流动性资产）。
**推荐周期**：中线（1H, 4H）为优；长线（日线）；短线（5m, 15m）仅建议高阶使用。
---

## 2. 技术指标配置 (Technical Indicators)

系统核心由6条均线组成，分为MA（简单移动平均线）和EMA（指数移动平均线）两组。

| 指标类型              | 周期参数 | 视频中颜色参考 | 逻辑定义     |
| :-------------------- | :------- | :------------- | :----------- |
| **MA (Simple)**       | 20       | 黄色           | 短期趋势基准 |
| **MA (Simple)**       | 60       | 蓝色           | 中期趋势基准 |
| **MA (Simple)**       | 120      | 紫红色         | 长期趋势基准 |
| **EMA (Exponential)** | 20       | 浅黄色         | 短期加权基准 |
| **EMA (Exponential)** | 60       | 浅蓝色         | 中期加权基准 |
| **EMA (Exponential)** | 120      | 浅紫色         | 长期加权基准 |

---

## 3. 核心市场状态定义

程序需要识别两种核心状态：**均线密集**和**均线发散**。

### 3.1 均线密集 (Consolidation/Squeeze)

- **视觉描述**：K线图上6条均线（MA20/60/120, EMA20/60/120）像麻绳一样缠绕在一起，分不清谁在上谁在下。
- **程序化定义建议**：计算6条均线当前数值的标准差（Standard Deviation）或极差（Max-Min），当该值低于某一特定阈值（需回测确定）或处于历史低波动区间时，标记为“均线密集”状态。
- **市场含义**：市场平均持仓成本趋于一致，即将选择方向。

### 3.2 均线发散 (Expansion/Trend)

- **视觉描述**：均线像头发被风吹散一样打开，呈现有序排列。
  - **多头排列（上涨）**：短期均线 > 中期均线 > 长期均线（20 > 60 > 120）。
  - **空头排列（下跌）**：短期均线 < 中期均线 < 长期均线（20 < 60 < 120）。
- **市场含义**：趋势行情正在进行中。

---

## 4. 进场策略 (Entry Logic)

本系统包含两种制式化的开仓模式。

### 策略 A：均线密集突破开仓法 (Breakout & Retest)

此策略用于捕捉趋势的**启动点**。

1.  **前置条件**：检测到当前处于**均线密集**状态。
2.  **触发信号**：
    - **做多**：价格向上突破密集区，随后**回踩（Retest）**密集区但不跌破（有效支撑），再次上涨时开仓。
    - **做空**：价格向下跌破密集区，随后**反弹（Retest）**密集区但不突破（有效阻力），再次下跌时开仓。
3.  **过滤器**：
    - 确认K线与均线的相对位置。做多需K线在均线密集上方；做空需K线在均线密集下方。

### 策略 B：趋势中首次回踩 MA20 (First Pullback to MA20)

此策略用于捕捉趋势的**中继点**（加仓或踏空后的上车点）。

1.  **前置条件**：
    - 市场已脱离密集状态，处于**均线发散**阶段（明确的趋势中）。
    - MA20（黑色/黄色线）方向明确（向上或向下）。
2.  **触发信号**：
    - **做多**：在上涨发散趋势中，价格**第一次**下跌回踩 MA20 均线，但未有效跌破（获得支撑并收回），在确认支撑后开仓。
    - **做空**：在下跌发散趋势中，价格**第一次**反弹触碰 MA20 均线，但未有效突破（受阻回落），在确认压力后开仓。

---

## 5. 止损策略 (Stop Loss)

系统的核心原则是“依据什么开仓，就依据什么止损”。

- **针对策略 A（密集突破）**：
  - 止损位设在**均线密集区的另一侧**或**有效跌破/突破均线密集区**时。
  - _逻辑_：如果价格重新回到密集区内部并穿过，说明突破失败（假突破）。
- **针对策略 B（回踩 MA20）**：
  - 止损位设在**有效跌破/突破 MA20** 时。
  - _逻辑_：如果价格无法守住 MA20 趋势线，说明短期趋势可能结束或转弱。

---

## 6. 止盈策略 (Take Profit)

提供三种止盈逻辑，自动化系统可设为可选参数。

1.  **固定盈亏比 (Fixed Risk:Reward)**：
    - 设置盈亏比至少为 **1:3** 或 **1:5**。
    - 计算公式：止盈价格 = 开仓价 ± (止损距离 × 3)。
2.  **前一密集区 (Previous Consolidation Zone)**：
    - 利用历史K线数据，寻找上一个“均线密集区”作为目标位（阻力/支撑位）。
    - _逻辑_：历史密集区代表套牢盘成本，易产生反向抛压/支撑。
3.  **斐波那契扩展 (Fibonacci Extension)**：
    - **适用场景**：价格突破历史新高（无上方阻力参考）时。
    - **目标位**：分批止盈于 1.618, 2.618, 3.618, 4.236 位置。

---

## 7. 资金管理与仓位计算 (Position Sizing)

系统强调非梭哈，严格控制单笔风险。

- **单笔最大亏损金额 (Max Risk per Trade)**：固定数值（如账户总额的 1% - 2% 或固定 $100）。
- **仓位计算公式**：
  $$ \text{开仓数量 (Position Size)} = \frac{\text{单笔最大亏损金额}}{|\text{开仓价格} - \text{止损价格}|} $$
  - _注：此公式确保无论止损距离宽窄，亏损金额恒定_。
- **杠杆设置**：
  - **实际杠杆 (Real Leverage)**：推荐 **< 3倍**（针对中长线）。
  - 程序应监控实际杠杆 = (持仓名义价值 / 账户权益)。

---

## 8. 开发注意事项 (Developer Notes)

1.  **“有效”突破/跌破的定义**：视频中多次提到“有效”，在代码中通常需要定义为：
    - K线收盘价（Close）越过均线。
    - 或者连续 N 根K线保持在均线/区域之外。
2.  **假突破过滤**：策略A强调“回踩不破”或“反弹不过”。程序逻辑应为：`Breakout -> Pullback -> Confirmation`，而不是单纯触碰就交易。
3.  **数据清洗**：均线计算应基于收盘价。
4.  **手续费控制**：由于胜率较低（30%-40%），交易成本对净值影响大，回测时必须计入交易手续费（Maker/Taker fees）。

---

**免责声明**：本系统文档基于视频源整理，仅供技术实现参考。视频源强调该系统胜率可能仅为 30%-40%，依赖高盈亏比获利，且过往业绩不代表未来表现。在使用真金白银交易前，请务必进行充分的历史回测。
